# 莲藕摆渡一体化心理赋能平台 - 后台系统规划

## 1. 系统架构设计

### 1.1 总体架构

采用前后端分离架构，确保系统的可扩展性和灵活性：

```
┌─────────────────────────────────────────────────────────────────┐
│                        前端应用层                               │
│  ┌───────────────┐  ┌───────────────┐  ┌───────────────────┐     │
│  │  管理后台 Web │  │  用户移动端   │  │  第三方接入端    │     │
│  └───────────────┘  └───────────────┘  └───────────────────┘     │
└─────────────────────────────────────────────────────────────────┘
                              │
┌─────────────────────────────────────────────────────────────────┐
│                        API 网关层                               │
│  ┌───────────────┐  ┌───────────────┐  ┌───────────────────┐     │
│  │  认证授权     │  │  请求路由     │  │  限流熔断        │     │
│  └───────────────┘  └───────────────┘  └───────────────────┘     │
└─────────────────────────────────────────────────────────────────┘
                              │
┌─────────────────────────────────────────────────────────────────┐
│                        应用服务层                               │
│  ┌───────────────┐  ┌───────────────┐  ┌───────────────────┐     │
│  │  用户管理     │  │  内容管理     │  │  心理测评        │     │
│  ├───────────────┤  ├───────────────┤  ├───────────────────┤     │
│  │  任务管理     │  │  积分系统     │  │  数据分析        │     │
│  ├───────────────┤  ├───────────────┤  ├───────────────────┤     │
│  │  通知管理     │  │  资源管理     │  │  系统配置        │     │
│  └───────────────┘  └───────────────┘  └───────────────────┘     │
└─────────────────────────────────────────────────────────────────┘
                              │
┌─────────────────────────────────────────────────────────────────┐
│                        数据服务层                               │
│  ┌───────────────┐  ┌───────────────┐  ┌───────────────────┐     │
│  │  关系型数据库 │  │  NoSQL数据库   │  │  文件存储        │     │
│  └───────────────┘  └───────────────┘  └───────────────────┘     │
└─────────────────────────────────────────────────────────────────┘
```

### 1.2 核心功能模块

#### 1.2.1 用户管理模块
- **用户信息管理**：注册、编辑、查询、禁用/启用用户
- **角色权限管理**：基于RBAC的权限控制，支持多角色定义
- **用户分组管理**：按地区、类型、状态等维度分组
- **登录日志**：记录用户登录行为，支持审计

#### 1.2.2 内容管理模块
- **课程管理**：创建、编辑、发布、下架课程
- **兴趣小组管理**：管理小组信息、成员、活动
- **职业广场管理**：发布、审核、管理就业岗位
- **文章资讯管理**：发布心理健康相关资讯

#### 1.2.3 心理测评模块
- **测评量表管理**：上传、编辑、管理心理测评量表
- **测评记录管理**：查看用户测评结果，生成分析报告
- **风险预警**：根据测评结果自动触发风险预警
- **测评模板**：支持自定义测评模板

#### 1.2.4 任务管理模块
- **任务模板管理**：创建、编辑任务模板
- **个性化任务分配**：基于用户画像自动分配任务
- **任务进度跟踪**：实时监控用户任务完成情况
- **任务效果评估**：分析任务完成对用户的影响

#### 1.2.5 积分系统模块
- **积分规则配置**：设置积分获取和消耗规则
- **积分记录管理**：查看用户积分变动记录
- **积分兑换管理**：管理可兑换资源和兑换记录
- **积分统计分析**：分析积分体系对用户活跃度的影响

#### 1.2.6 通知管理模块
- **消息模板管理**：创建、编辑通知模板
- **消息推送管理**：手动或自动推送消息
- **消息记录查询**：查看消息发送状态和记录
- **多渠道支持**：支持APP推送、短信、邮件等多种渠道

#### 1.2.7 数据分析模块
- **用户画像分析**：生成用户多维度画像
- **行为数据分析**：分析用户使用行为
- **心理状态趋势**：跟踪用户心理状态变化
- **系统运营数据**：统计系统各项运营指标

#### 1.2.8 资源管理模块
- **文件资源管理**：上传、存储、管理各类文件
- **资源分类管理**：对资源进行分类和标签管理
- **资源访问控制**：设置资源访问权限
- **资源统计分析**：分析资源使用情况

## 2. 数据库设计

### 2.1 核心数据模型

#### 2.1.1 用户表 (users)
```sql
CREATE TABLE users (
    id INT PRIMARY KEY AUTO_INCREMENT,
    user_id VARCHAR(50) UNIQUE NOT NULL COMMENT '用户唯一标识',
    username VARCHAR(50) COMMENT '用户名',
    password_hash VARCHAR(255) COMMENT '密码哈希',
    real_name VARCHAR(50) COMMENT '真实姓名',
    id_card VARCHAR(18) UNIQUE COMMENT '身份证号',
    phone VARCHAR(20) UNIQUE COMMENT '手机号',
    email VARCHAR(100) UNIQUE COMMENT '邮箱',
    gender TINYINT COMMENT '性别：0-未知，1-男，2-女',
    birth_date DATE COMMENT '出生日期',
    release_date DATE COMMENT '释放日期',
    status TINYINT DEFAULT 1 COMMENT '状态：0-禁用，1-启用',
    role_id INT COMMENT '角色ID',
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    last_login_at TIMESTAMP
);
```

#### 2.1.2 角色表 (roles)
```sql
CREATE TABLE roles (
    id INT PRIMARY KEY AUTO_INCREMENT,
    role_name VARCHAR(50) UNIQUE NOT NULL COMMENT '角色名称',
    description TEXT COMMENT '角色描述',
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP
);
```

#### 2.1.3 权限表 (permissions)
```sql
CREATE TABLE permissions (
    id INT PRIMARY KEY AUTO_INCREMENT,
    permission_name VARCHAR(50) UNIQUE NOT NULL COMMENT '权限名称',
    permission_code VARCHAR(50) UNIQUE NOT NULL COMMENT '权限代码',
    description TEXT COMMENT '权限描述',
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP
);
```

#### 2.1.4 课程表 (courses)
```sql
CREATE TABLE courses (
    id INT PRIMARY KEY AUTO_INCREMENT,
    course_code VARCHAR(50) UNIQUE NOT NULL COMMENT '课程代码',
    title VARCHAR(200) NOT NULL COMMENT '课程标题',
    description TEXT COMMENT '课程描述',
    category_id INT COMMENT '课程分类ID',
    cover_image VARCHAR(255) COMMENT '封面图片',
    video_url VARCHAR(255) COMMENT '视频地址',
    duration INT COMMENT '课程时长（秒）',
    difficulty TINYINT COMMENT '难度：1-简单，2-中等，3-困难',
    status TINYINT DEFAULT 0 COMMENT '状态：0-草稿，1-发布，2-下架',
    created_by INT COMMENT '创建人ID',
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    publish_at TIMESTAMP COMMENT '发布时间'
);
```

#### 2.1.5 心理测评表 (assessments)
```sql
CREATE TABLE assessments (
    id INT PRIMARY KEY AUTO_INCREMENT,
    assessment_code VARCHAR(50) UNIQUE NOT NULL COMMENT '测评代码',
    title VARCHAR(200) NOT NULL COMMENT '测评标题',
    description TEXT COMMENT '测评描述',
    type TINYINT COMMENT '测评类型：1-自评，2-他评',
    duration INT COMMENT '预计时长（分钟）',
    status TINYINT DEFAULT 0 COMMENT '状态：0-草稿，1-启用，2-停用',
    created_by INT COMMENT '创建人ID',
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP
);
```

#### 2.1.6 测评问题表 (assessment_questions)
```sql
CREATE TABLE assessment_questions (
    id INT PRIMARY KEY AUTO_INCREMENT,
    assessment_id INT NOT NULL COMMENT '所属测评ID',
    question_text TEXT NOT NULL COMMENT '问题内容',
    question_type TINYINT COMMENT '问题类型：1-单选，2-多选，3-填空，4-量表',
    options JSON COMMENT '选项（JSON格式）',
    score_rule JSON COMMENT '评分规则（JSON格式）',
    sort_order INT DEFAULT 0 COMMENT '排序顺序',
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    FOREIGN KEY (assessment_id) REFERENCES assessments(id) ON DELETE CASCADE
);
```

#### 2.1.7 测评记录表 (assessment_records)
```sql
CREATE TABLE assessment_records (
    id INT PRIMARY KEY AUTO_INCREMENT,
    user_id INT NOT NULL COMMENT '用户ID',
    assessment_id INT NOT NULL COMMENT '测评ID',
    total_score DECIMAL(10,2) COMMENT '总分',
    result JSON COMMENT '测评结果（JSON格式）',
    risk_level TINYINT COMMENT '风险等级：1-低，2-中，3-高',
    status TINYINT DEFAULT 0 COMMENT '状态：0-未完成，1-已完成',
    started_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP COMMENT '开始时间',
    completed_at TIMESTAMP COMMENT '完成时间',
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (user_id) REFERENCES users(id),
    FOREIGN KEY (assessment_id) REFERENCES assessments(id)
);
```

#### 2.1.8 任务表 (tasks)
```sql
CREATE TABLE tasks (
    id INT PRIMARY KEY AUTO_INCREMENT,
    task_code VARCHAR(50) UNIQUE NOT NULL COMMENT '任务代码',
    title VARCHAR(200) NOT NULL COMMENT '任务标题',
    description TEXT COMMENT '任务描述',
    task_type TINYINT COMMENT '任务类型：1-学习，2-实践，3-测评，4-社交',
    target_score INT COMMENT '目标积分',
    status TINYINT DEFAULT 0 COMMENT '状态：0-草稿，1-启用，2-停用',
    created_by INT COMMENT '创建人ID',
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP
);
```

#### 2.1.9 用户任务表 (user_tasks)
```sql
CREATE TABLE user_tasks (
    id INT PRIMARY KEY AUTO_INCREMENT,
    user_id INT NOT NULL COMMENT '用户ID',
    task_id INT NOT NULL COMMENT '任务ID',
    status TINYINT DEFAULT 0 COMMENT '状态：0-未开始，1-进行中，2-已完成，3-已过期',
    progress INT DEFAULT 0 COMMENT '进度（%）',
    score INT DEFAULT 0 COMMENT '获得积分',
    assigned_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP COMMENT '分配时间',
    completed_at TIMESTAMP COMMENT '完成时间',
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    FOREIGN KEY (user_id) REFERENCES users(id),
    FOREIGN KEY (task_id) REFERENCES tasks(id)
);
```

#### 2.1.10 积分记录表 (points_records)
```sql
CREATE TABLE points_records (
    id INT PRIMARY KEY AUTO_INCREMENT,
    user_id INT NOT NULL COMMENT '用户ID',
    points INT NOT NULL COMMENT '积分变动',
    type TINYINT COMMENT '类型：1-获得，2-消耗',
    source VARCHAR(50) COMMENT '积分来源/用途',
    related_id INT COMMENT '关联ID',
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (user_id) REFERENCES users(id)
);
```

## 3. 技术栈选择

### 3.1 后端技术栈

| 技术/框架          | 版本    | 用途                          | 选型理由                                  |
|-------------------|---------|-------------------------------|-------------------------------------------|
| Spring Boot       | 3.0+    | 应用框架                      | 成熟稳定，生态丰富，适合企业级应用开发      |
| Spring Security   | 6.0+    | 认证授权                      | 与Spring Boot深度集成，支持多种认证方式    |
| MyBatis Plus      | 3.5+    | ORM框架                       | 简化数据库操作，支持Lambda表达式查询        |
| MySQL             | 8.0+    | 关系型数据库                  | 成熟稳定，适合结构化数据存储                |
| Redis             | 7.0+    | 缓存数据库                    | 提高系统性能，支持分布式缓存              |
| RabbitMQ          | 3.11+   | 消息队列                      | 支持异步处理，解耦系统组件                |
| MinIO             | RELEASE | 对象存储                      | 轻量级对象存储，适合存储大量文件资源        |
| Docker            | 20.10+  | 容器化部署                    | 简化部署流程，提高环境一致性              |
| Kubernetes        | 1.25+   | 容器编排                      | 支持高可用部署，自动扩缩容                |

### 3.2 前端技术栈

| 技术/框架          | 版本    | 用途                          | 选型理由                                  |
|-------------------|---------|-------------------------------|-------------------------------------------|
| Vue.js            | 3.3+    | 前端框架                      | 渐进式框架，易于学习和使用                |
| Element Plus      | 2.3+    | UI组件库                      | 与Vue 3深度集成，组件丰富美观              |
| Axios             | 1.4+    | HTTP客户端                    | 支持拦截器，易于配置和扩展                |
| Vue Router        | 4.2+    | 路由管理                      | 与Vue 3兼容，支持嵌套路由和动态路由        |
| Pinia             | 2.1+    | 状态管理                      | 轻量级状态管理，支持TypeScript            |
| ECharts           | 5.4+    | 数据可视化                    | 图表类型丰富，支持交互式数据展示          |
| Vue-i18n          | 9.2+    | 国际化支持                    | 支持多语言切换，适合不同地区使用          |

## 4. 系统安全设计

### 4.1 认证与授权
- 采用JWT (JSON Web Token) 进行身份认证
- 基于RBAC模型实现细粒度权限控制
- 支持多因素认证，提高安全性

### 4.2 数据安全
- 敏感数据加密存储（如密码、身份证号等）
- 数据传输采用HTTPS加密
- 定期数据备份策略
- 数据脱敏处理，保护用户隐私

### 4.3 系统安全
- 实现API接口限流，防止恶意请求
- 防止SQL注入、XSS攻击等常见安全漏洞
- 定期安全审计和漏洞扫描
- 完善的日志记录和监控体系

## 5. 开发计划

### 5.1 阶段划分

| 阶段       | 时间跨度   | 主要任务                                  |
|------------|------------|-------------------------------------------|
| 需求分析   | 2周        | 详细需求调研，确定功能边界                |
| 系统设计   | 2周        | 架构设计，数据库设计，接口设计            |
| 基础框架搭建 | 1周        | 搭建后端基础框架，配置开发环境            |
| 核心功能开发 | 8周        | 开发用户管理、内容管理、心理测评等核心模块 |
| 前端开发   | 6周        | 开发管理后台和用户移动端界面              |
| 测试与优化 | 3周        | 系统测试，性能优化，安全加固              |
| 部署上线   | 1周        | 系统部署，上线准备，用户培训              |

### 5.2 关键里程碑

1. **基础框架完成**：后端框架搭建完成，支持基本的认证授权
2. **核心功能完成**：用户管理、内容管理、心理测评模块开发完成
3. **前端界面完成**：管理后台和用户移动端界面开发完成
4. **系统测试完成**：通过功能测试、性能测试、安全测试
5. **系统上线**：正式部署上线，开始试运行

## 6. 系统扩展性设计

### 6.1 模块化设计
- 采用微服务架构思想，各模块独立开发和部署
- 定义清晰的模块间接口，降低耦合度

### 6.2 数据扩展
- 支持分库分表，应对大数据量增长
- 数据索引优化，提高查询性能

### 6.3 功能扩展
- 提供插件机制，支持功能扩展
- 开放API接口，支持第三方系统集成

## 7. 系统监控与运维

### 7.1 监控体系
- 应用性能监控（APM）
- 系统资源监控
- 日志集中管理
- 异常告警机制

### 7.2 运维工具
- CI/CD流水线，自动化构建和部署
- 配置中心，统一管理配置
- 服务注册与发现，支持服务动态扩容

## 8. 总结

本规划设计了一套完整的后台系统架构，涵盖了莲藕摆渡一体化心理赋能平台的核心功能模块。系统采用前后端分离架构，基于Spring Boot和Vue.js技术栈开发，具有良好的可扩展性和安全性。

系统设计充分考虑了用户需求和业务场景，支持心理测评、任务管理、积分系统等核心功能，并提供了完善的数据分析和监控机制。通过合理的技术选型和架构设计，确保系统能够高效、稳定地运行，为刑满释放人员提供优质的心理赋能服务。

后续将根据实际开发进度和用户反馈，持续优化和完善系统功能，确保系统能够更好地满足业务需求和用户期望。